<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Smart Weighing Scale: firmware/bootloader/external/mbedtls/include/mbedtls/ecdh.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="customdoxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="2" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Smart Weighing Scale
   </div>
   <!-- PROJECT BRIEF is expected to be a URL -->
   <div id="projectbrief"><a href=https://github.com/IoTReady/weighing_scale_nrf>https://github.com/IoTReady/weighing_scale_nrf</a></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('ecdh_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ecdh.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Elliptic curve Diffie-Hellman.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="mbedtls_2include_2mbedtls_2ecp_8h_source.html">ecp.h</a>&quot;</code><br />
</div>
<p><a href="ecdh_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">ECDH context structure.  <a href="structmbedtls__ecdh__context.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ae5df12f2068df09a102e05e02fb1e39c"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdh_8h.html#ae5df12f2068df09a102e05e02fb1e39c">mbedtls_ecdh_side</a> { <a class="el" href="ecdh_8h.html#ae5df12f2068df09a102e05e02fb1e39ca28e1b43484f53d02de24809228780703">MBEDTLS_ECDH_OURS</a>
, <a class="el" href="ecdh_8h.html#ae5df12f2068df09a102e05e02fb1e39caee83a43a270657fc7dc2f26c91d2addb">MBEDTLS_ECDH_THEIRS</a>
 }</td></tr>
<tr class="separator:ae5df12f2068df09a102e05e02fb1e39c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a403a5d7363b6219a2017b837b665c354"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdh_8h.html#a403a5d7363b6219a2017b837b665c354">mbedtls_ecdh_gen_public</a> (<a class="el" href="structmbedtls__ecp__group.html">mbedtls_ecp_group</a> *grp, <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *d, <a class="el" href="structmbedtls__ecp__point.html">mbedtls_ecp_point</a> *Q, int(*f_rng)(void *, unsigned char *, size_t), void *p_rng)</td></tr>
<tr class="memdesc:a403a5d7363b6219a2017b837b665c354"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a public key. Raw function that only does the core computation.  <a href="ecdh_8h.html#a403a5d7363b6219a2017b837b665c354">More...</a><br /></td></tr>
<tr class="separator:a403a5d7363b6219a2017b837b665c354"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca0670e79f3002a218d6da8c8dee61e1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdh_8h.html#aca0670e79f3002a218d6da8c8dee61e1">mbedtls_ecdh_compute_shared</a> (<a class="el" href="structmbedtls__ecp__group.html">mbedtls_ecp_group</a> *grp, <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *z, const <a class="el" href="structmbedtls__ecp__point.html">mbedtls_ecp_point</a> *Q, const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *d, int(*f_rng)(void *, unsigned char *, size_t), void *p_rng)</td></tr>
<tr class="memdesc:aca0670e79f3002a218d6da8c8dee61e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute shared secret Raw function that only does the core computation.  <a href="ecdh_8h.html#aca0670e79f3002a218d6da8c8dee61e1">More...</a><br /></td></tr>
<tr class="separator:aca0670e79f3002a218d6da8c8dee61e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97e787a12f7aae180ab9828303199dca"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdh_8h.html#a97e787a12f7aae180ab9828303199dca">mbedtls_ecdh_init</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx)</td></tr>
<tr class="memdesc:a97e787a12f7aae180ab9828303199dca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize context.  <a href="ecdh_8h.html#a97e787a12f7aae180ab9828303199dca">More...</a><br /></td></tr>
<tr class="separator:a97e787a12f7aae180ab9828303199dca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89cc40dc92fbbaf0275ea9a6184a5e71"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdh_8h.html#a89cc40dc92fbbaf0275ea9a6184a5e71">mbedtls_ecdh_free</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx)</td></tr>
<tr class="memdesc:a89cc40dc92fbbaf0275ea9a6184a5e71"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free context.  <a href="ecdh_8h.html#a89cc40dc92fbbaf0275ea9a6184a5e71">More...</a><br /></td></tr>
<tr class="separator:a89cc40dc92fbbaf0275ea9a6184a5e71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a784e56d5eea12e38374e9ce028692940"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdh_8h.html#a784e56d5eea12e38374e9ce028692940">mbedtls_ecdh_make_params</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx, size_t *olen, unsigned char *buf, size_t blen, int(*f_rng)(void *, unsigned char *, size_t), void *p_rng)</td></tr>
<tr class="memdesc:a784e56d5eea12e38374e9ce028692940"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a public key and a TLS ServerKeyExchange payload. (First function used by a TLS server for ECDHE.)  <a href="ecdh_8h.html#a784e56d5eea12e38374e9ce028692940">More...</a><br /></td></tr>
<tr class="separator:a784e56d5eea12e38374e9ce028692940"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af07326ad0017bf6fcfb9f93e43641254"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdh_8h.html#af07326ad0017bf6fcfb9f93e43641254">mbedtls_ecdh_read_params</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx, const unsigned char **buf, const unsigned char *end)</td></tr>
<tr class="memdesc:af07326ad0017bf6fcfb9f93e43641254"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse and procress a TLS ServerKeyExhange payload. (First function used by a TLS client for ECDHE.)  <a href="ecdh_8h.html#af07326ad0017bf6fcfb9f93e43641254">More...</a><br /></td></tr>
<tr class="separator:af07326ad0017bf6fcfb9f93e43641254"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c03b82213c39abd90a5bd4b1646441d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdh_8h.html#a3c03b82213c39abd90a5bd4b1646441d">mbedtls_ecdh_get_params</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx, const <a class="el" href="structmbedtls__ecp__keypair.html">mbedtls_ecp_keypair</a> *key, <a class="el" href="ecdh_8h.html#ae5df12f2068df09a102e05e02fb1e39c">mbedtls_ecdh_side</a> side)</td></tr>
<tr class="memdesc:a3c03b82213c39abd90a5bd4b1646441d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup an ECDH context from an EC key. (Used by clients and servers in place of the ServerKeyEchange for static ECDH: import ECDH parameters from a certificate's EC key information.)  <a href="ecdh_8h.html#a3c03b82213c39abd90a5bd4b1646441d">More...</a><br /></td></tr>
<tr class="separator:a3c03b82213c39abd90a5bd4b1646441d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a417fd45ce78adb1b52027f995fa5ee57"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdh_8h.html#a417fd45ce78adb1b52027f995fa5ee57">mbedtls_ecdh_make_public</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx, size_t *olen, unsigned char *buf, size_t blen, int(*f_rng)(void *, unsigned char *, size_t), void *p_rng)</td></tr>
<tr class="memdesc:a417fd45ce78adb1b52027f995fa5ee57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a public key and a TLS ClientKeyExchange payload. (Second function used by a TLS client for ECDH(E).)  <a href="ecdh_8h.html#a417fd45ce78adb1b52027f995fa5ee57">More...</a><br /></td></tr>
<tr class="separator:a417fd45ce78adb1b52027f995fa5ee57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f417d90797b109d3036feb288e33207"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdh_8h.html#a9f417d90797b109d3036feb288e33207">mbedtls_ecdh_read_public</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx, const unsigned char *buf, size_t blen)</td></tr>
<tr class="memdesc:a9f417d90797b109d3036feb288e33207"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse and process a TLS ClientKeyExchange payload. (Second function used by a TLS server for ECDH(E).)  <a href="ecdh_8h.html#a9f417d90797b109d3036feb288e33207">More...</a><br /></td></tr>
<tr class="separator:a9f417d90797b109d3036feb288e33207"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a423fee27a0c8603bba336cbfe6dadcaa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdh_8h.html#a423fee27a0c8603bba336cbfe6dadcaa">mbedtls_ecdh_calc_secret</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx, size_t *olen, unsigned char *buf, size_t blen, int(*f_rng)(void *, unsigned char *, size_t), void *p_rng)</td></tr>
<tr class="memdesc:a423fee27a0c8603bba336cbfe6dadcaa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Derive and export the shared secret. (Last function used by both TLS client en servers.)  <a href="ecdh_8h.html#a423fee27a0c8603bba336cbfe6dadcaa">More...</a><br /></td></tr>
<tr class="separator:a423fee27a0c8603bba336cbfe6dadcaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Elliptic curve Diffie-Hellman. </p>
<p>Copyright (C) 2006-2015, ARM Limited, All Rights Reserved SPDX-License-Identifier: Apache-2.0</p>
<p>Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at</p>
<p><a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></p>
<p>Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.</p>
<p>This file is part of mbed TLS (<a href="https://tls.mbed.org">https://tls.mbed.org</a>) </p>
</div><h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ae5df12f2068df09a102e05e02fb1e39c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5df12f2068df09a102e05e02fb1e39c">&#9670;&nbsp;</a></span>mbedtls_ecdh_side</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="ecdh_8h.html#ae5df12f2068df09a102e05e02fb1e39c">mbedtls_ecdh_side</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>When importing from an EC key, select if it is our key or the peer's key </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ae5df12f2068df09a102e05e02fb1e39ca28e1b43484f53d02de24809228780703"></a>MBEDTLS_ECDH_OURS&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ae5df12f2068df09a102e05e02fb1e39caee83a43a270657fc7dc2f26c91d2addb"></a>MBEDTLS_ECDH_THEIRS&#160;</td><td class="fielddoc"></td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a423fee27a0c8603bba336cbfe6dadcaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a423fee27a0c8603bba336cbfe6dadcaa">&#9670;&nbsp;</a></span>mbedtls_ecdh_calc_secret()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_calc_secret </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>olen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>blen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *, unsigned char *, size_t)&#160;</td>
          <td class="paramname"><em>f_rng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_rng</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Derive and export the shared secret. (Last function used by both TLS client en servers.) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>ECDH context </td></tr>
    <tr><td class="paramname">olen</td><td>number of bytes written </td></tr>
    <tr><td class="paramname">buf</td><td>destination buffer </td></tr>
    <tr><td class="paramname">blen</td><td>buffer length </td></tr>
    <tr><td class="paramname">f_rng</td><td>RNG function, see notes for <code><a class="el" href="ecdh_8h.html#aca0670e79f3002a218d6da8c8dee61e1" title="Compute shared secret Raw function that only does the core computation.">mbedtls_ecdh_compute_shared()</a></code> </td></tr>
    <tr><td class="paramname">p_rng</td><td>RNG parameter</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or an MBEDTLS_ERR_ECP_XXX error code </dd></dl>

</div>
</div>
<a id="aca0670e79f3002a218d6da8c8dee61e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca0670e79f3002a218d6da8c8dee61e1">&#9670;&nbsp;</a></span>mbedtls_ecdh_compute_shared()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_compute_shared </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecp__group.html">mbedtls_ecp_group</a> *&#160;</td>
          <td class="paramname"><em>grp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmbedtls__ecp__point.html">mbedtls_ecp_point</a> *&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *, unsigned char *, size_t)&#160;</td>
          <td class="paramname"><em>f_rng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_rng</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute shared secret Raw function that only does the core computation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">grp</td><td>ECP group </td></tr>
    <tr><td class="paramname">z</td><td>Destination MPI (shared secret) </td></tr>
    <tr><td class="paramname">Q</td><td>Public key from other party </td></tr>
    <tr><td class="paramname">d</td><td>Our secret exponent (private key) </td></tr>
    <tr><td class="paramname">f_rng</td><td>RNG function (see notes) </td></tr>
    <tr><td class="paramname">p_rng</td><td>RNG parameter</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or a MBEDTLS_ERR_ECP_XXX or MBEDTLS_MPI_XXX error code</dd></dl>
<dl class="section note"><dt>Note</dt><dd>If f_rng is not NULL, it is used to implement countermeasures against potential elaborate timing attacks, see <code><a class="el" href="mbedtls_2include_2mbedtls_2ecp_8h.html#a4d005045c302e100c78bdc587e8f0e6a" title="Multiplication by an integer: R = m * P (Not thread-safe to use same group in multiple threads)">mbedtls_ecp_mul()</a></code> for details. </dd></dl>

</div>
</div>
<a id="a89cc40dc92fbbaf0275ea9a6184a5e71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89cc40dc92fbbaf0275ea9a6184a5e71">&#9670;&nbsp;</a></span>mbedtls_ecdh_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mbedtls_ecdh_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>Context to free </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a403a5d7363b6219a2017b837b665c354"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a403a5d7363b6219a2017b837b665c354">&#9670;&nbsp;</a></span>mbedtls_ecdh_gen_public()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_gen_public </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecp__group.html">mbedtls_ecp_group</a> *&#160;</td>
          <td class="paramname"><em>grp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecp__point.html">mbedtls_ecp_point</a> *&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *, unsigned char *, size_t)&#160;</td>
          <td class="paramname"><em>f_rng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_rng</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate a public key. Raw function that only does the core computation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">grp</td><td>ECP group </td></tr>
    <tr><td class="paramname">d</td><td>Destination MPI (secret exponent, aka private key) </td></tr>
    <tr><td class="paramname">Q</td><td>Destination point (public key) </td></tr>
    <tr><td class="paramname">f_rng</td><td>RNG function </td></tr>
    <tr><td class="paramname">p_rng</td><td>RNG parameter</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or a MBEDTLS_ERR_ECP_XXX or MBEDTLS_MPI_XXX error code </dd></dl>

</div>
</div>
<a id="a3c03b82213c39abd90a5bd4b1646441d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c03b82213c39abd90a5bd4b1646441d">&#9670;&nbsp;</a></span>mbedtls_ecdh_get_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_get_params </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmbedtls__ecp__keypair.html">mbedtls_ecp_keypair</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ecdh_8h.html#ae5df12f2068df09a102e05e02fb1e39c">mbedtls_ecdh_side</a>&#160;</td>
          <td class="paramname"><em>side</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Setup an ECDH context from an EC key. (Used by clients and servers in place of the ServerKeyEchange for static ECDH: import ECDH parameters from a certificate's EC key information.) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>ECDH constext to set </td></tr>
    <tr><td class="paramname">key</td><td>EC key to use </td></tr>
    <tr><td class="paramname">side</td><td>Is it our key (1) or the peer's key (0) ?</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or an MBEDTLS_ERR_ECP_XXX error code </dd></dl>

</div>
</div>
<a id="a97e787a12f7aae180ab9828303199dca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97e787a12f7aae180ab9828303199dca">&#9670;&nbsp;</a></span>mbedtls_ecdh_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mbedtls_ecdh_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>Context to initialize </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a784e56d5eea12e38374e9ce028692940"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a784e56d5eea12e38374e9ce028692940">&#9670;&nbsp;</a></span>mbedtls_ecdh_make_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_make_params </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>olen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>blen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *, unsigned char *, size_t)&#160;</td>
          <td class="paramname"><em>f_rng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_rng</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate a public key and a TLS ServerKeyExchange payload. (First function used by a TLS server for ECDHE.) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>ECDH context </td></tr>
    <tr><td class="paramname">olen</td><td>number of chars written </td></tr>
    <tr><td class="paramname">buf</td><td>destination buffer </td></tr>
    <tr><td class="paramname">blen</td><td>length of buffer </td></tr>
    <tr><td class="paramname">f_rng</td><td>RNG function </td></tr>
    <tr><td class="paramname">p_rng</td><td>RNG parameter</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function assumes that ctx-&gt;grp has already been properly set (for example using mbedtls_ecp_group_load).</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or an MBEDTLS_ERR_ECP_XXX error code </dd></dl>

</div>
</div>
<a id="a417fd45ce78adb1b52027f995fa5ee57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a417fd45ce78adb1b52027f995fa5ee57">&#9670;&nbsp;</a></span>mbedtls_ecdh_make_public()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_make_public </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>olen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>blen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *, unsigned char *, size_t)&#160;</td>
          <td class="paramname"><em>f_rng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_rng</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate a public key and a TLS ClientKeyExchange payload. (Second function used by a TLS client for ECDH(E).) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>ECDH context </td></tr>
    <tr><td class="paramname">olen</td><td>number of bytes actually written </td></tr>
    <tr><td class="paramname">buf</td><td>destination buffer </td></tr>
    <tr><td class="paramname">blen</td><td>size of destination buffer </td></tr>
    <tr><td class="paramname">f_rng</td><td>RNG function </td></tr>
    <tr><td class="paramname">p_rng</td><td>RNG parameter</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or an MBEDTLS_ERR_ECP_XXX error code </dd></dl>

</div>
</div>
<a id="af07326ad0017bf6fcfb9f93e43641254"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af07326ad0017bf6fcfb9f93e43641254">&#9670;&nbsp;</a></span>mbedtls_ecdh_read_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_read_params </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char **&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>end</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse and procress a TLS ServerKeyExhange payload. (First function used by a TLS client for ECDHE.) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>ECDH context </td></tr>
    <tr><td class="paramname">buf</td><td>pointer to start of input buffer </td></tr>
    <tr><td class="paramname">end</td><td>one past end of buffer</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or an MBEDTLS_ERR_ECP_XXX error code </dd></dl>

</div>
</div>
<a id="a9f417d90797b109d3036feb288e33207"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f417d90797b109d3036feb288e33207">&#9670;&nbsp;</a></span>mbedtls_ecdh_read_public()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_read_public </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>blen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse and process a TLS ClientKeyExchange payload. (Second function used by a TLS server for ECDH(E).) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>ECDH context </td></tr>
    <tr><td class="paramname">buf</td><td>start of input buffer </td></tr>
    <tr><td class="paramname">blen</td><td>length of input buffer</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or an MBEDTLS_ERR_ECP_XXX error code </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d9edf6c004b4a7ff14fe9ae7a92214ee.html">firmware</a></li><li class="navelem"><a class="el" href="dir_c54c06661e2a67506b5e7cd3af6ea490.html">bootloader</a></li><li class="navelem"><a class="el" href="dir_adf56eb6fb3eae33097338ecda7df27e.html">external</a></li><li class="navelem"><a class="el" href="dir_114d78f365ddc7bb4d1ffece60ffb429.html">mbedtls</a></li><li class="navelem"><a class="el" href="dir_9aac99c81f27c2c33894cf8550185067.html">include</a></li><li class="navelem"><a class="el" href="dir_aef85cebb0f616cd0ef95a661d2d1c3a.html">mbedtls</a></li><li class="navelem"><a class="el" href="ecdh_8h.html">ecdh.h</a></li>
    <li class="footer">Generated by <a href="https://iotready.co"> IoTReady </a><img class="footer" src="logo.png" width="30" height="30" alt="IoTReady"/></a></li>
  </ul>
</div>
</body>
</html>
